{"code":"import { __extends } from \"tslib\";\r\nimport classNames from 'classnames';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport { Text, View } from '@tarojs/components';\r\nimport Taro from '@tarojs/taro';\r\nvar AtNoticebar = /** @class */ (function (_super) {\r\n    __extends(AtNoticebar, _super);\r\n    function AtNoticebar(props) {\r\n        var _this = _super.call(this, props) || this;\r\n        var animElemId = \"J_\".concat(Math.ceil(Math.random() * 10e5).toString(36));\r\n        _this.state = {\r\n            show: true,\r\n            animElemId: animElemId,\r\n            animationData: {\r\n                actions: [{}]\r\n            },\r\n            dura: 0,\r\n            isWEAPP: Taro.getEnv() === Taro.ENV_TYPE.WEAPP,\r\n            isALIPAY: Taro.getEnv() === Taro.ENV_TYPE.ALIPAY,\r\n            isWEB: Taro.getEnv() === Taro.ENV_TYPE.WEB\r\n        };\r\n        return _this;\r\n    }\r\n    AtNoticebar.prototype.onClose = function (event) {\r\n        this.setState({\r\n            show: false\r\n        });\r\n        this.props.onClose && this.props.onClose(event);\r\n    };\r\n    AtNoticebar.prototype.onGotoMore = function (event) {\r\n        this.props.onGotoMore && this.props.onGotoMore(event);\r\n    };\r\n    AtNoticebar.prototype.UNSAFE_componentWillReceiveProps = function () {\r\n        if (!this.timeout) {\r\n            this.interval && clearInterval(this.interval);\r\n            this.initAnimation();\r\n        }\r\n    };\r\n    AtNoticebar.prototype.componentDidMount = function () {\r\n        if (!this.props.marquee)\r\n            return;\r\n        this.initAnimation();\r\n    };\r\n    AtNoticebar.prototype.initAnimation = function () {\r\n        var _this = this;\r\n        var _a = this.state, isWEAPP = _a.isWEAPP, isALIPAY = _a.isALIPAY;\r\n        this.timeout = setTimeout(function () {\r\n            _this.timeout = null;\r\n            if (_this.state.isWEB) {\r\n                var _a = _this.props.speed, speed = _a === void 0 ? 100 : _a;\r\n                var elem = document.querySelector(\".\".concat(_this.state.animElemId));\r\n                if (!elem)\r\n                    return;\r\n                var width = elem.getBoundingClientRect().width;\r\n                var dura = width / +speed;\r\n                _this.setState({ dura: dura });\r\n            }\r\n            else if (isWEAPP || isALIPAY) {\r\n                var query = Taro.createSelectorQuery();\r\n                query\r\n                    .select(\".\".concat(_this.state.animElemId))\r\n                    .boundingClientRect()\r\n                    .exec(function (res) {\r\n                    var queryRes = res[0];\r\n                    if (!queryRes)\r\n                        return;\r\n                    var width = queryRes.width;\r\n                    var _a = _this.props.speed, speed = _a === void 0 ? 100 : _a;\r\n                    var dura = width / +speed;\r\n                    var animation = Taro.createAnimation({\r\n                        duration: dura * 1000,\r\n                        timingFunction: 'linear'\r\n                    });\r\n                    var resetAnimation = Taro.createAnimation({\r\n                        duration: 0,\r\n                        timingFunction: 'linear'\r\n                    });\r\n                    var resetOpacityAnimation = Taro.createAnimation({\r\n                        duration: 0,\r\n                        timingFunction: 'linear'\r\n                    });\r\n                    var animBody = function () {\r\n                        resetOpacityAnimation.opacity(0).step();\r\n                        _this.setState({ animationData: resetOpacityAnimation.export() });\r\n                        setTimeout(function () {\r\n                            resetAnimation.translateX(0).step();\r\n                            _this.setState({ animationData: resetAnimation.export() });\r\n                        }, 300);\r\n                        setTimeout(function () {\r\n                            resetOpacityAnimation.opacity(1).step();\r\n                            _this.setState({ animationData: resetOpacityAnimation.export() });\r\n                        }, 600);\r\n                        setTimeout(function () {\r\n                            animation.translateX(-width).step();\r\n                            _this.setState({ animationData: animation.export() });\r\n                        }, 900);\r\n                    };\r\n                    animBody();\r\n                    _this.interval = setInterval(animBody, dura * 1000 + 1000);\r\n                });\r\n            }\r\n        }, 1000);\r\n    };\r\n    AtNoticebar.prototype.render = function () {\r\n        var _a = this.props, single = _a.single, icon = _a.icon, marquee = _a.marquee, customStyle = _a.customStyle, className = _a.className, _b = _a.moreText, moreText = _b === void 0 ? '查看详情' : _b;\r\n        var _c = this.props, showMore = _c.showMore, close = _c.close;\r\n        var _d = this.state, dura = _d.dura, show = _d.show, animElemId = _d.animElemId, animationData = _d.animationData, isWEAPP = _d.isWEAPP, isALIPAY = _d.isALIPAY;\r\n        var rootClassName = ['at-noticebar'];\r\n        if (!single)\r\n            showMore = false;\r\n        var style = {};\r\n        var innerClassName = ['at-noticebar__content-inner'];\r\n        if (marquee) {\r\n            close = false;\r\n            innerClassName.push(animElemId);\r\n            style['animation-delay'] = '3s';\r\n            if (dura > 0) {\r\n                style['animation-duration'] = \"\".concat(dura, \"s\");\r\n                style['animation-delay'] = '1s';\r\n            }\r\n        }\r\n        var classObject = {\r\n            'at-noticebar--marquee': marquee,\r\n            'at-noticebar--weapp': marquee && (isWEAPP || isALIPAY),\r\n            'at-noticebar--single': !marquee && single\r\n        };\r\n        var iconClass = ['at-icon'];\r\n        if (icon)\r\n            iconClass.push(\"at-icon-\".concat(icon));\r\n        return (show && (React.createElement(View, { className: classNames(rootClassName, classObject, className), style: customStyle },\r\n            close && (React.createElement(View, { className: 'at-noticebar__close', onClick: this.onClose.bind(this) },\r\n                React.createElement(Text, { className: 'at-icon at-icon-close' }))),\r\n            React.createElement(View, { className: 'at-noticebar__content' },\r\n                icon && (React.createElement(View, { className: 'at-noticebar__content-icon' },\r\n                    React.createElement(Text, { className: classNames(iconClass, iconClass) }))),\r\n                React.createElement(View, { className: 'at-noticebar__content-text' },\r\n                    React.createElement(View, { id: animElemId, animation: animationData, className: classNames(innerClassName), style: style }, this.props.children))),\r\n            showMore && (React.createElement(View, { className: 'at-noticebar__more', onClick: this.onGotoMore.bind(this) },\r\n                React.createElement(Text, { className: 'text' }, moreText),\r\n                React.createElement(View, { className: 'at-noticebar__more-icon' },\r\n                    React.createElement(Text, { className: 'at-icon at-icon-chevron-right' })))))));\r\n    };\r\n    return AtNoticebar;\r\n}(React.Component));\r\nexport default AtNoticebar;\r\nAtNoticebar.defaultProps = {\r\n    close: false,\r\n    single: false,\r\n    marquee: false,\r\n    speed: 100,\r\n    moreText: '查看详情',\r\n    showMore: false,\r\n    icon: '',\r\n    customStyle: {}\r\n};\r\nAtNoticebar.propTypes = {\r\n    close: PropTypes.bool,\r\n    single: PropTypes.bool,\r\n    marquee: PropTypes.bool,\r\n    speed: PropTypes.number,\r\n    moreText: PropTypes.string,\r\n    showMore: PropTypes.bool,\r\n    icon: PropTypes.string,\r\n    customStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\r\n    onClose: PropTypes.func,\r\n    onGotoMore: PropTypes.func\r\n};\r\n//# sourceMappingURL=index.js.map","references":["/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@types+classnames@2.2.10/node_modules/@types/classnames/index.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/prop-types@15.7.2/node_modules/prop-types/index.js","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@types+react@18.2.21/node_modules/@types/react/ts5.0/index.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@tarojs+components@3.6.6_@types+react-native@0.64.13_@types+react@18.2.21_react@18.2.0/node_modules/@tarojs/components/types/index.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@tarojs+components@3.6.6_@types+react-native@0.64.13_@types+react@18.2.21_react@18.2.0/node_modules/@tarojs/components/types/common.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@tarojs+taro@3.6.6_@types+react@18.2.21/node_modules/@tarojs/taro/types/index.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/packages/taro-ui/types/noticebar.d.ts"],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/components/noticebar/index.tsx\"],\"names\":[],\"mappings\":\"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\"}"}
