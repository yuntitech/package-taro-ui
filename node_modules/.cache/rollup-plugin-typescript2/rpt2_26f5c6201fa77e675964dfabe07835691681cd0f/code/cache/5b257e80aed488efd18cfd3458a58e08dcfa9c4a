{"code":"import { __extends } from \"tslib\";\r\nimport classNames from 'classnames';\r\nimport _toString from 'lodash/toString';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport { Input, Text, View } from '@tarojs/components';\r\nimport { pxTransform } from '../../common/utils';\r\n// TODO: Check all types\r\n// 实现两数相加并保留小数点后最短尾数\r\nfunction addNum(num1, num2) {\r\n    var sq1, sq2;\r\n    try {\r\n        sq1 = _toString(num1).split('.')[1].length;\r\n    }\r\n    catch (e) {\r\n        sq1 = 0;\r\n    }\r\n    try {\r\n        sq2 = _toString(num2).split('.')[1].length;\r\n    }\r\n    catch (e) {\r\n        sq2 = 0;\r\n    }\r\n    var m = Math.pow(10, Math.max(sq1, sq2));\r\n    return (Math.round(num1 * m) + Math.round(num2 * m)) / m;\r\n}\r\n// 格式化数字，处理01变成1,并且不处理1. 这种情况\r\nfunction parseValue(num) {\r\n    if (num === '')\r\n        return '0';\r\n    var numStr = _toString(num);\r\n    if (numStr.indexOf('0') === 0 && numStr.indexOf('.') === -1) {\r\n        // 处理01变成1,并且不处理1.\r\n        return _toString(parseFloat(num));\r\n    }\r\n    return _toString(num);\r\n}\r\nvar AtInputNumber = /** @class */ (function (_super) {\r\n    __extends(AtInputNumber, _super);\r\n    function AtInputNumber() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.handleValue = function (value) {\r\n            var _a = _this.props, _b = _a.max, max = _b === void 0 ? 100 : _b, _c = _a.min, min = _c === void 0 ? 0 : _c;\r\n            var resultValue = value === '' ? min : value;\r\n            // 此处不能使用 Math.max，会是字符串变数字，并丢失 .\r\n            if (Number(resultValue) > max) {\r\n                resultValue = max;\r\n                _this.handleError({\r\n                    type: 'OVER',\r\n                    errorValue: resultValue\r\n                });\r\n            }\r\n            if (Number(resultValue) < min) {\r\n                resultValue = min;\r\n                _this.handleError({\r\n                    type: 'LOW',\r\n                    errorValue: resultValue\r\n                });\r\n            }\r\n            if (resultValue && !Number(resultValue)) {\r\n                resultValue = parseFloat(String(resultValue)) || min;\r\n                _this.handleError({\r\n                    type: 'OVER',\r\n                    errorValue: resultValue\r\n                });\r\n            }\r\n            resultValue = parseValue(String(resultValue));\r\n            return resultValue;\r\n        };\r\n        _this.handleInput = function (e) {\r\n            var value = e.target.value;\r\n            var disabled = _this.props.disabled;\r\n            if (disabled)\r\n                return '';\r\n            var newValue = _this.handleValue(value);\r\n            _this.props.onChange(Number(newValue), e);\r\n            return newValue;\r\n        };\r\n        _this.handleBlur = function (event) {\r\n            return _this.props.onBlur && _this.props.onBlur(event);\r\n        };\r\n        _this.handleError = function (errorValue) {\r\n            if (!_this.props.onErrorInput) {\r\n                return;\r\n            }\r\n            _this.props.onErrorInput(errorValue);\r\n        };\r\n        return _this;\r\n    }\r\n    AtInputNumber.prototype.handleClick = function (clickType, e) {\r\n        var _a = this.props, disabled = _a.disabled, value = _a.value, _b = _a.min, min = _b === void 0 ? 0 : _b, _c = _a.max, max = _c === void 0 ? 100 : _c, _d = _a.step, step = _d === void 0 ? 1 : _d;\r\n        var lowThanMin = clickType === 'minus' && Number(value) <= min;\r\n        var overThanMax = clickType === 'plus' && Number(value) >= max;\r\n        if (lowThanMin || overThanMax || disabled) {\r\n            var deltaValue_1 = clickType === 'minus' ? -step : step;\r\n            var errorValue = addNum(Number(value), deltaValue_1);\r\n            if (disabled) {\r\n                this.handleError({\r\n                    type: 'DISABLED',\r\n                    errorValue: errorValue\r\n                });\r\n            }\r\n            else {\r\n                this.handleError({\r\n                    type: lowThanMin ? 'LOW' : 'OVER',\r\n                    errorValue: errorValue\r\n                });\r\n            }\r\n            return;\r\n        }\r\n        var deltaValue = clickType === 'minus' ? -step : step;\r\n        var newValue = addNum(Number(value), deltaValue);\r\n        newValue = Number(this.handleValue(newValue));\r\n        this.props.onChange(newValue, e);\r\n    };\r\n    AtInputNumber.prototype.render = function () {\r\n        var _a = this.props, customStyle = _a.customStyle, className = _a.className, width = _a.width, disabled = _a.disabled, value = _a.value, type = _a.type, _b = _a.min, min = _b === void 0 ? 0 : _b, _c = _a.max, max = _c === void 0 ? 100 : _c, size = _a.size, disabledInput = _a.disabledInput;\r\n        var inputStyle = {\r\n            width: width ? \"\".concat(pxTransform(width)) : ''\r\n        };\r\n        var inputValue = Number(this.handleValue(value));\r\n        var rootCls = classNames('at-input-number', {\r\n            'at-input-number--lg': size === 'large'\r\n        }, className);\r\n        var minusBtnCls = classNames('at-input-number__btn', {\r\n            'at-input-number--disabled': inputValue <= min || disabled\r\n        });\r\n        var plusBtnCls = classNames('at-input-number__btn', {\r\n            'at-input-number--disabled': inputValue >= max || disabled\r\n        });\r\n        return (React.createElement(View, { className: rootCls, style: customStyle },\r\n            React.createElement(View, { className: minusBtnCls, onClick: this.handleClick.bind(this, 'minus') },\r\n                React.createElement(Text, { className: 'at-icon at-icon-subtract at-input-number__btn-subtract' })),\r\n            React.createElement(Input, { className: 'at-input-number__input', style: inputStyle, type: type, value: String(inputValue), disabled: disabledInput || disabled, onInput: this.handleInput, onBlur: this.handleBlur }),\r\n            React.createElement(View, { className: plusBtnCls, onClick: this.handleClick.bind(this, 'plus') },\r\n                React.createElement(Text, { className: 'at-icon at-icon-add at-input-number__btn-add' }))));\r\n    };\r\n    return AtInputNumber;\r\n}(React.Component));\r\nexport default AtInputNumber;\r\nAtInputNumber.defaultProps = {\r\n    customStyle: {},\r\n    className: '',\r\n    disabled: false,\r\n    disabledInput: false,\r\n    value: 1,\r\n    type: 'number',\r\n    width: 0,\r\n    min: 0,\r\n    max: 100,\r\n    step: 1,\r\n    size: 'normal',\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    onChange: function () { }\r\n};\r\nAtInputNumber.propTypes = {\r\n    customStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\r\n    className: PropTypes.oneOfType([PropTypes.array, PropTypes.string]),\r\n    value: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n    type: PropTypes.oneOf(['number', 'digit']),\r\n    disabled: PropTypes.bool,\r\n    width: PropTypes.number,\r\n    min: PropTypes.number,\r\n    max: PropTypes.number,\r\n    step: PropTypes.number,\r\n    size: PropTypes.oneOf(['normal', 'large']),\r\n    disabledInput: PropTypes.bool,\r\n    onChange: PropTypes.func,\r\n    onBlur: PropTypes.func,\r\n    onErrorInput: PropTypes.func\r\n};\r\n//# sourceMappingURL=index.js.map","references":["/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@types+classnames@2.2.10/node_modules/@types/classnames/index.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/lodash@4.17.10/node_modules/lodash/toString.js","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/prop-types@15.7.2/node_modules/prop-types/index.js","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@types+react@18.2.21/node_modules/@types/react/ts5.0/index.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@tarojs+components@3.6.6_@types+react-native@0.64.13_@types+react@18.2.21_react@18.2.0/node_modules/@tarojs/components/types/index.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/node_modules/.pnpm/@tarojs+components@3.6.6_@types+react-native@0.64.13_@types+react@18.2.21_react@18.2.0/node_modules/@tarojs/components/types/common.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/packages/taro-ui/types/input-number.d.ts","/Users/leejunhui/Develop/React/Library/taro-ui/packages/taro-ui/src/common/utils.ts"],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/components/input-number/index.tsx\"],\"names\":[],\"mappings\":\"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\"}"}
